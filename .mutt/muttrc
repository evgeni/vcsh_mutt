set reverse_name  

set header_cache="~/.cache/mutt/headers"
set message_cachedir="~/.cache/mutt/bodies"
set certificate_file=~/.mutt/certificates

set mail_check=90
set timeout=15

set rfc2047_parameters

set beep_new

set pipe_split

auto_view text/html
alternative_order text/enriched text/plain text

# needs the sidebar.patch from http://www.lunar-linux.org/mutt-sidebar/
# available in Debian as "mutt-patched"
# available for Fedora at https://copr.fedoraproject.org/coprs/evgeni/mutt-patched/

set sidebar_width=20
#set sidebar_sort
set sidebar_shortpath
set sidebar_folderindent
set sidebar_visible
# ctrl-n, ctrl-p to select next, prev folder 
# ctrl-o to open selected folder 
bind index \Cp sidebar-prev 
bind index \Cn sidebar-next 
bind index \Co sidebar-open 
bind pager \Cp sidebar-prev 
bind pager \Cn sidebar-next 
bind pager \Co sidebar-open

# b toggles sidebar visibility
#macro index \Cb ':toggle sidebar_visible^M'
#macro pager \Cb ':toggle sidebar_visible^M'
macro index \Cb '<enter-command>toggle sidebar_visible<enter><refresh>'
macro pager \Cb '<enter-command>toggle sidebar_visible<enter><redraw-screen>' 

set sort=threads

set narrow_tree

# use notmuch-mutt (https://notmuchmail.org/notmuch-mutt/) to search for mail
# available in Debian as notmuch-mutt
# available in Fedora as notmuch-mutt

macro index <F8> \
"<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
<shell-escape>notmuch-mutt -r --prompt search<enter>\
<change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>\
<enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>" \
      "notmuch: search mail"

macro index <F9> \
"<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
<pipe-message>notmuch-mutt -r thread<enter>\
<change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>\
<enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>" \
      "notmuch: reconstruct thread"

macro index <F6> \
"<enter-command>set my_old_pipe_decode=\$pipe_decode my_old_wait_key=\$wait_key nopipe_decode nowait_key<enter>\
<pipe-message>notmuch-mutt tag -- -inbox<enter>\
<enter-command>set pipe_decode=\$my_old_pipe_decode wait_key=\$my_old_wait_key<enter>" \
      "notmuch: remove message from inbox"

# use goobook (https://gitlab.com/goobook/goobook)
# available in Debian as goobook
# available in Fedora as goobook

set query_command="goobook query '%s'"
bind editor <Tab> complete-query
macro index,pager a "<pipe-message>goobook add<return>" "add the sender address to Google contacts"

# use solarized theme from https://github.com/altercation/solarized/tree/master/mutt-colors-solarized

source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-16.muttrc

# account specific settings
set mbox_type=Maildir
set folder="~/Mail/redhat"
set spoolfile="=INBOX"
mailboxes `find ~/Mail/redhat -type d -name cur -printf '%h \0' |LC_COLLATE=C sort -z| xargs -0`
#mailboxes `find ~/Mail/ -type d -name cur -printf '%h '`
set record="=Sent"
set postponed="=Drafts"
set from=egolov@redhat.com
alternates (egolov|evgeni|evgeni.golov)@redhat.com

set signature=~/.mutt/signature.redhat
